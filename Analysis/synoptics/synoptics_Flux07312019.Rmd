---
title: "Flux at Synoptic Points"
author: "Chloe"
date: "7/31/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# Plots and Analysis
library(here)
library(ggplot2)
library(tidyr)
library(dplyr)
library(wesanderson)
library('knitr')

```

## Plots and Analysis

```{r readData, echo=FALSE}
#flux of synoptics 

date<- "08012019"



eos2 <- read.csv(here("FieldData/EosFD",paste0("eos2_",date,".csv")))
eos2$Year <- paste0("20",eos2$Year)
eos2$dateTime <- as.POSIXct(as.character(paste0(eos2$Month,"/",eos2$Day,"/",eos2$Year," ",eos2$Time)), format = "%m/%d/%Y%H:%M:%OS")
eos2 <- eos2%>%
  select(dateTime,Flux,Temperature..C.,CO2.Soil..ppm..,
         CO2.Soil.STD..ppm.,CO2.ATM..ppm.,CO2.ATM.STD..ppm.,Mode)
colnames(eos2) <- c("DateTime","Flux_eos2","Temp_C_eos2","CO2_Soil_ppm_eos2","CO2_Soil_STD_ppm_eos2","CO2_ATM_ppm_eos2","CO2_ATM_STD_ppm_eos2","Mode")

eos1 <- read.csv(here("FieldData/EosFD",paste0("eos1_FIX_07312019.csv")))
#eos1$Year <- paste0("20",eos1$Year)
#eos1$dateTime <- as.POSIXct(as.character(paste0(eos1$Month,"/",eos1$Day,"/",eos1$Year," ",eos1$Time)), format = "%m/%d/%Y %H:%M:%OS")
eos1 <- eos1%>%
  select(DateTime,Flux_1,Temp_C_1,CO2_Soil_1,
        CO2_Soil_STD_1,CO2_ATM_1,CO2_ATM_STD_1,Mode_1)
colnames(eos1) <- c("DateTime","Flux_eos1","Temp_C_eos1","CO2_Soil_ppm_eos1","CO2_Soil_STD_ppm_eos1","CO2_ATM_ppm_eos1","CO2_ATM_STD_ppm_eos1","Mode")



syn1 <- eos2[2177:2180,]
syn5 <- eos2[2183:2186,]
syn8 <- eos2[2188:2191,]
syn11 <- eos2[2193:2196,]
syn14 <- eos2[2200:2203,]
waterfall <- eos1[2534:2537,]
syn20 <- eos1[2540:2543,]
syn23 <- eos1[2546:2549,]
syn29 <- eos1[2552:2555,]
syn35 <- eos1[2557:2560,]

```



### Flux of Synoptic Sites

Syn1
```{r data, eval=TRUE, warning=FALSE, echo=FALSE, fig.width = 12}

syn1 <- select(syn1,DateTime, Flux_eos2)
kable(head(syn1), format = "markdown", row.names = FALSE)

```
Syn5
```{r , eval=TRUE, warning=FALSE, echo=FALSE, fig.width = 12}

syn5 <- select(syn5,DateTime, Flux_eos2)
kable(head(syn5), format = "markdown", row.names = FALSE)

```
Syn8
```{r , eval=TRUE, warning=FALSE, echo=FALSE, fig.width = 12}

syn8 <- select(syn8,DateTime, Flux_eos2)
kable(head(syn8), format = "markdown", row.names = FALSE)

```
Syn11
```{r , eval=TRUE, warning=FALSE, echo=FALSE, fig.width = 12}

syn11 <- select(syn11,DateTime, Flux_eos2)
kable(head(syn11), format = "markdown", row.names = FALSE)

```
Syn14
```{r , eval=TRUE, warning=FALSE, echo=FALSE, fig.width = 12}

syn14 <- select(syn14,DateTime, Flux_eos2)
kable(head(syn14), format = "markdown", row.names = FALSE)

```
SynWaterfall
```{r , eval=TRUE, warning=FALSE, echo=FALSE, fig.width = 12}

waterfall <- select(waterfall,DateTime, Flux_eos1)
kable(head(waterfall), format = "markdown", row.names = FALSE)

```
Syn20
```{r , eval=TRUE, warning=FALSE, echo=FALSE, fig.width = 12}

syn20 <- select(syn20,DateTime, Flux_eos1)
kable(head(syn20), format = "markdown", row.names = FALSE)

```
Syn23
```{r , eval=TRUE, warning=FALSE, echo=FALSE, fig.width = 12}

syn23 <- select(syn23,DateTime, Flux_eos1)
kable(head(syn23), format = "markdown", row.names = FALSE)

```
Syn29
```{r , eval=TRUE, warning=FALSE, echo=FALSE, fig.width = 12}

syn29 <- select(syn29,DateTime, Flux_eos1)
kable(head(syn29), format = "markdown", row.names = FALSE)

```
Syn35
```{r , eval=TRUE, warning=FALSE, echo=FALSE, fig.width = 12}

syn35 <- select(syn35,DateTime, Flux_eos1)
kable(head(syn35), format = "markdown", row.names = FALSE)

```

Average Flux of Each Site
```{r , eval=TRUE, warning=FALSE, echo=FALSE, fig.width = 12}
syn1avg <- mean(syn1$Flux_eos2)
syn5avg <- mean(syn5$Flux_eos2)
syn8avg <- mean(syn8$Flux_eos2)
syn11avg <- mean(syn11$Flux_eos2)
syn14avg <- mean(syn14$Flux_eos2)
waterfallavg <- mean(waterfall$Flux_eos1)
syn20avg <- mean(syn20$Flux_eos1)
syn23avg <- mean(syn23$Flux_eos1)
syn29avg <- mean(syn29$Flux_eos1)
syn35avg <- mean(syn35$Flux_eos1)

syn1sd <- sd(syn1$Flux_eos2)
syn5sd <- sd(syn5$Flux_eos2)
syn8sd <- sd(syn8$Flux_eos2)
syn11sd <- sd(syn11$Flux_eos2)
syn14sd <- sd(syn14$Flux_eos2)
waterfallsd <- sd(waterfall$Flux_eos1)
syn20sd <- sd(syn20$Flux_eos1)
syn23sd <- sd(syn23$Flux_eos1)
syn29sd <- sd(syn29$Flux_eos1)
syn35sd <- sd(syn35$Flux_eos1)


a <- data.frame(AverageFlux = c(syn35avg, syn29avg, syn23avg, syn20avg, waterfallavg, syn14avg, syn11avg, syn8avg, syn5avg, syn1avg)) 

rownames(a) <- c("syn35", "syn29", "syn23", "syn20", "waterfall", "syn14", "syn11", "syn8", "syn 5", "syn1") 

 

kable(a, format = "markdown", row.names = TRUE) 

 

 

sd <- data.frame(StdDev= 

c(syn35sd, syn29sd, syn23sd, syn20sd, waterfallsd, syn14sd, syn11sd, syn8sd, syn5sd, syn1sd)) 

rownames(sd) <- c("syn35", "syn29", "syn23", "syn20", "waterfall", "syn14", "syn11", "syn8", "syn 5", "syn1") 

kable(sd, format = "markdown", row.names = TRUE) 

 

a <- cbind(a,sd) 

 

avgplot <- ggplot(a)+ 

 geom_errorbar(aes(x= 1:10,ymin= AverageFlux - StdDev, ymax= AverageFlux + StdDev), width=0.2, size=1, color="blue") +   

  geom_point(aes(x= 1:10, y= AverageFlux), color = "blue", size = 2)  

 

avgplot <- avgplot + scale_x_continuous(breaks=1:10, labels=c("syn35", "syn29", "syn23", "syn20", "waterfall", "syn14", "syn11", "syn8", "syn 5", "syn1")) + 

labs(x = "Synoptic Site", y = "Average FLux") 

avgplot 

 

dis35 <- 0 

dis29 <- 37.4 

dis23 <- 75.9 

dis20 <- 94.1 

waterfalldis <- 126 

dis14 <- 143.7 

dis11 <- 169.9 

dis8 <- 194.9 

dis5 <- 217.6 

dis1<- 245.2 

dis <- data.frame(Distance = c(dis35, dis29, dis23, dis20, waterfalldis, dis14, dis11, dis8, dis5, dis1)) 

rownames(dis) <- c("syn35", "syn29", "syn23", "syn20", "waterfall", "syn14", "syn11", "syn8", "syn 5", "syn1") 

kable(dis, format = "markdown", row.names = TRUE) 

 

c <- cbind(a,dis) 

 

 

displot <- ggplot(c)+ 

 geom_errorbar(aes(x= Distance,y= AverageFlux, ymin= AverageFlux - StdDev, ymax= AverageFlux + StdDev), width=0.2, size=1, color="blue") +   

  geom_point(aes(x= Distance, y= AverageFlux), color = "blue", size = 2) 

 

#displot <- displot + scale_x_continuous(breaks=1:10, labels=c("syn35", "syn29", "syn23", "syn20", "waterfall", "syn14", "syn11", "syn8", "syn 5", "syn1")) + 

displot <- displot +  

  labs(x = "Synoptic Site Distance from Wetland (m)", y = "Average FLux (Î¼mol/CO2/m2/s)") 

displot 

 

 

``` 