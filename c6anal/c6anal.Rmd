---
title: "C6 Data Anaylsis"
author: "Meg Raisle"
date: "November 15th, 2019"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
library(tmaptools)
library(ggplot2)
library(here)
library(dplyr)
library(plotly)
library(wesanderson)
library(viridis)
library(grid)
library('knitr')
```

```{r readData, echo=FALSE}
c6time <- read.csv(here("c6anal/alldatac6times.csv"))
c6time$DateTime <- as.POSIXct(c6time$DateTime)
#basic graph of all four 

#set same x-scale for each 
x_min <- as.POSIXct("2019-07-11 11:45:00")
x_max <- as.POSIXct("2019-07-19 12:59:00")

largernumbers <- element_text(face = "bold", size = 30)
largernumbers2 <- element_text(face = "bold", size = 20)

#let's make the boxplots for the 2 injections that happened during the c6 time 
CDOMinjpoly <- data.frame(x = c(as.POSIXct("2019-07-12 13:00:00"),
                            as.POSIXct("2019-07-12 16:00:00"),
                            as.POSIXct("2019-07-12 16:00:00"),
                            as.POSIXct("2019-07-12 13:00:00")),y=c(15,15,50,50))





CDOMinjpoly2 <- data.frame(x = c(as.POSIXct("2019-07-16 14:15:00"),
                             as.POSIXct("2019-07-16 20:00:00"),
                             as.POSIXct("2019-07-16 20:00:00"),
                             as.POSIXct("2019-07-16 14:15:00")),y=c(15,15,50,50))
turbinjpoly <- data.frame(x = c(as.POSIXct("2019-07-12 13:00:00"),
                                as.POSIXct("2019-07-12 16:00:00"),
                                as.POSIXct("2019-07-12 16:00:00"),
                                as.POSIXct("2019-07-12 13:00:00")),y=c(0,0,3000,3000))

turbinjpoly2 <- data.frame(x = c(as.POSIXct("2019-07-16 14:15:00"),
                                 as.POSIXct("2019-07-16 20:00:00"),
                                 as.POSIXct("2019-07-16 20:00:00"),
                                 as.POSIXct("2019-07-16 14:15:00")),y=c(0,0,3000,3000))
chloinjpoly <- data.frame(x = c(as.POSIXct("2019-07-12 13:00:00"),
                                as.POSIXct("2019-07-12 16:00:00"),
                                as.POSIXct("2019-07-12 16:00:00"),
                                as.POSIXct("2019-07-12 13:00:00")),y=c(0,0,5,5))

chloinjpoly2 <- data.frame(x = c(as.POSIXct("2019-07-16 14:15:00"),
                                 as.POSIXct("2019-07-16 20:00:00"),
                                 as.POSIXct("2019-07-16 20:00:00"),
                                 as.POSIXct("2019-07-16 14:15:00")),y=c(0,0,5,5))
phycoinjpoly <- data.frame(x = c(as.POSIXct("2019-07-12 13:00:00"),
                                as.POSIXct("2019-07-12 16:00:00"),
                                as.POSIXct("2019-07-12 16:00:00"),
                                as.POSIXct("2019-07-12 13:00:00")),y=c(0,0,1500,1500))

phycoinjpoly2 <- data.frame(x = c(as.POSIXct("2019-07-16 14:15:00"),
                                 as.POSIXct("2019-07-16 20:00:00"),
                                 as.POSIXct("2019-07-16 20:00:00"),
                                 as.POSIXct("2019-07-16 14:15:00")),y=c(0,0,1500,1500))
c2injpoly <- data.frame(x = c(as.POSIXct("2019-07-12 13:00:00"),
                                 as.POSIXct("2019-07-12 16:00:00"),
                                 as.POSIXct("2019-07-12 16:00:00"),
                                 as.POSIXct("2019-07-12 13:00:00")),y=c(1000,1000,5000,5000))

c2injpoly2 <- data.frame(x = c(as.POSIXct("2019-07-16 14:15:00"),
                                  as.POSIXct("2019-07-16 20:00:00"),
                                  as.POSIXct("2019-07-16 20:00:00"),
                                  as.POSIXct("2019-07-16 14:15:00")),y=c(1000,1000,5000,5000))
fluxinjpoly <- data.frame(x = c(as.POSIXct("2019-07-12 13:00:00"),
                              as.POSIXct("2019-07-12 16:00:00"),
                              as.POSIXct("2019-07-12 16:00:00"),
                              as.POSIXct("2019-07-12 13:00:00")),y=c(0,0,4,4))

fluxinjpoly2 <- data.frame(x = c(as.POSIXct("2019-07-16 14:15:00"),
                               as.POSIXct("2019-07-16 20:00:00"),
                               as.POSIXct("2019-07-16 20:00:00"),
                               as.POSIXct("2019-07-16 14:15:00")),y=c(0,0,4,4))
#do basic plot of each 
plot <- ggplot(c6time)+
  geom_polygon(data = CDOMinjpoly,aes(x=x,y=y),fill="#ff7722", alpha = .5)+
  geom_polygon(data = CDOMinjpoly2,aes(x=x,y=y),fill="#ff7722", alpha = .5)+
  geom_point(aes(x= DateTime, y= CDOM_ppb), color= "#27223c", size=5)+
  ggtitle("Colored Dissolved Organic Matter")
plot <- plot + theme(axis.text.y= largernumbers, axis.text.x= largernumbers, plot.title =largernumbers, axis.title.x = largernumbers2, axis.title.y = largernumbers2)


plot2 <- ggplot(c6time)+
  geom_polygon(data = turbinjpoly,aes(x=x,y=y),fill="#ff7722", alpha = .5)+
  geom_polygon(data = turbinjpoly2,aes(x=x,y=y),fill="#ff7722", alpha = .5)+
  geom_point(aes(x= DateTime, y= Turbidity_NTU), color="#d1362f", size=5)+
  ggtitle("Turbidity")
plot2 <- plot2 +theme(axis.text.y= largernumbers, axis.text.x= largernumbers, plot.title =largernumbers, axis.title.x = largernumbers2, axis.title.y = largernumbers2)



plot3 <- ggplot(c6time)+
  geom_polygon(data = chloinjpoly,aes(x=x,y=y),fill="#ff7722", alpha = .5)+
  geom_polygon(data = chloinjpoly2,aes(x=x,y=y),fill="#ff7722", alpha = .5)+
  geom_point(aes(x= DateTime, y= Chlorophylla_ug.L), color="#2e604a", size=5)+
  ggtitle("Chlorophyll A")
plot3 <- plot3 + theme(axis.text.y= largernumbers,  axis.text.x= largernumbers,plot.title =largernumbers, axis.title.x = largernumbers2, axis.title.y = largernumbers2)



plot4 <- ggplot(c6time)+
  geom_polygon(data = phycoinjpoly,aes(x=x,y=y),fill="#ff7722", alpha = .5)+
  geom_polygon(data = phycoinjpoly2,aes(x=x,y=y),fill="#ff7722", alpha = .5)+
  geom_point(aes(x= DateTime, y= Phycocyanin_ppb), color="#dbb165", size=5)+
  ggtitle("Phycocyanin")
plot4 <- plot4 + theme(axis.text.y= largernumbers,  axis.text.x= largernumbers,plot.title =largernumbers, axis.title.x = largernumbers2, axis.title.y = largernumbers2)




plot5 <- ggplot(c6time)+
  geom_bar(aes(x= DateTime, y = ppt_mm), color = "#1dace8", stat="identity", size=5)+
  ggtitle("Five Minute Precipitation")
plot5 <- plot5 + theme(axis.text.y= largernumbers,  axis.text.x= largernumbers,plot.title =largernumbers, axis.title.x = largernumbers2, axis.title.y = largernumbers2)



plot6 <- ggplot(c6time)+
  geom_bar(aes(x= DateTime, y = ppt24Tot), color = "#1dace8", stat="identity", size=5)+
  ggtitle("Previous 24 Hours of Precipitation")
plot6 <- plot6 + theme(axis.text.y= largernumbers,  axis.text.x= largernumbers,plot.title =largernumbers, axis.title.x = largernumbers2, axis.title.y = largernumbers2)

plot7 <- ggplot(c6time)+
  geom_polygon(data = c2injpoly,aes(x=x,y=y),fill="#ff7722", alpha = .5)+
  geom_polygon(data = c2injpoly2,aes(x=x,y=y),fill="#ff7722", alpha = .5)+
  geom_point(aes(x= DateTime, y = V1), color = "#cecd7b", size=5)+
  geom_point(aes(x= DateTime, y = V2), color = "#1dace8", size=5)+
  ggtitle("Station 1 and 2 CO2")
plot7 <- plot7 + theme(axis.text.y= largernumbers,  axis.text.x= largernumbers,plot.title =largernumbers, axis.title.x = largernumbers2, axis.title.y = largernumbers2)

plot9 <- ggplot(c6time)+
  geom_polygon(data = fluxinjpoly,aes(x=x,y=y),fill="#ff7722", alpha = .5)+
  geom_polygon(data = fluxinjpoly2,aes(x=x,y=y),fill="#ff7722", alpha = .5)+
  geom_point(aes(x= DateTime, y = Flux_1), color = "#e6a2c5", size=5)+
  ggtitle("Flux Between Station 1 and 2")
plot9 <- plot9+ theme(axis.text.y= largernumbers,  axis.text.x= largernumbers,plot.title =largernumbers, axis.title.x = largernumbers2, axis.title.y = largernumbers2)



````

## Plot of each of the C6 Metrics over time 
This data is at a 15 minute interval from the time period of July 11-July 19
```{r , eval=TRUE, warning=FALSE, echo=FALSE, fig.width = 30, fig.height= 25}

grid.newpage()
grid.draw(rbind(ggplotGrob(plot), ggplotGrob(plot2), ggplotGrob(plot3), ggplotGrob(plot4)))

````

## Data with 5 Minute Precipitation Values 

```{r , eval=TRUE, warning=FALSE, echo=FALSE, fig.width = 30, fig.height= 25}
#first 5 min rainfall 

grid.newpage()
grid.draw(rbind(ggplotGrob(plot5),ggplotGrob(plot), ggplotGrob(plot2), ggplotGrob(plot3), ggplotGrob(plot4)))

````

## Data with Previous 24 Hour Precipitation
```{r , eval=TRUE, warning=FALSE, echo=FALSE, fig.width = 30, fig.height= 25}
#then 24 hour rainfall

grid.newpage()
grid.draw(rbind(ggplotGrob(plot6),ggplotGrob(plot), ggplotGrob(plot2), ggplotGrob(plot3), ggplotGrob(plot4)))           


````

## With Station 1 and 2 CO2 Data
```{r , eval=TRUE, warning=FALSE, echo=FALSE, fig.width = 30, fig.height= 25}
grid.newpage()
grid.draw(rbind(ggplotGrob(plot7),ggplotGrob(plot), ggplotGrob(plot2), ggplotGrob(plot3), ggplotGrob(plot4)))  

````
 Currently this is a bit decieving because of the two injections (7/12 and 7/16) - maybe subtract the injection amount from the data?

## With Flux Data
```{r , eval=TRUE, warning=FALSE, echo=FALSE, fig.width = 30, fig.height= 25}
grid.newpage()
grid.draw(rbind(ggplotGrob(plot9),ggplotGrob(plot), ggplotGrob(plot2), ggplotGrob(plot3), ggplotGrob(plot4)))  

````
Need to talk to Chloe about EOS movements. Some of the data in the latter portion of this graph might actually be from synoptics because on 7/16 we used both EOS for synoptics. That spike that occurs in all graphs around 7/14-15 is real in the EOS because it was in place during that rainstorm. 
